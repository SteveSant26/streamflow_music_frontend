<div class="song-actions">
  <!-- Quick action buttons for small and medium size -->
  @if (size === 'small' || size === 'medium') {
    <div class="flex items-center gap-1">
      <!-- Play button (only if showQuickPlay is true) -->
      @if (showQuickPlay) {
        <button
          (click)="playSong()"
          class="action-btn-small text-gray-400 hover:text-green-600 p-1 rounded-full hover:bg-gray-100 transition-colors"
          [attr.aria-label]="isCurrentSongPlaying() ? 'Pausar ' + song.title : 'Reproducir ' + song.title"
          [title]="isCurrentSongPlaying() ? 'Pausar' : 'Reproducir'"
        >
          <mat-icon class="w-4 h-4" [class.text-green-500]="isCurrentSongPlaying()">
            {{ isCurrentSongPlaying() ? 'pause' : 'play_arrow' }}
          </mat-icon>
        </button>
      }
      
      <!-- Add to queue -->
      <button
        (click)="addToQueue()"
        class="action-btn-small text-gray-400 hover:text-green-600 p-1 rounded-full hover:bg-gray-100 transition-colors"
        [attr.aria-label]="'Agregar ' + song.title + ' a cola'"
        title="Agregar a cola"
      >
        <mat-icon class="w-4 h-4">queue_music</mat-icon>
      </button>
      
      <!-- Add to playlist -->
      <button
        (click)="addToPlaylist()"
        class="action-btn-small text-gray-400 hover:text-blue-600 p-1 rounded-full hover:bg-gray-100 transition-colors"
        [attr.aria-label]="'Agregar ' + song.title + ' a playlist'"
        title="Agregar a playlist"
      >
        <mat-icon class="w-4 h-4">playlist_add</mat-icon>
      </button>
      
      <!-- Add to favorites -->
      <button
        (click)="addToFavorites()"
        class="action-btn-small text-gray-400 hover:text-red-600 p-1 rounded-full hover:bg-gray-100 transition-colors"
        [attr.aria-label]="'Agregar ' + song.title + ' a favoritos'"
        title="Agregar a favoritos"
      >
        <mat-icon class="w-4 h-4">favorite_border</mat-icon>
      </button>
      
      <!-- More options menu -->
      <button 
        mat-icon-button 
        [matMenuTriggerFor]="moreOptionsMenu"
        class="action-btn-small text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors"
        [attr.aria-label]="'Más opciones para ' + song.title"
        title="Más opciones">
        <mat-icon class="w-4 h-4">more_vert</mat-icon>
      </button>
    </div>
  } @else {
    <!-- Full menu button for large size -->
    <button 
      mat-icon-button 
      [matMenuTriggerFor]="actionsMenu"
      [matTooltip]="isCurrentSongPlaying() ? 'Canción reproduciéndose' : 'Opciones de reproducción'"
      [class]="isCurrentSongPlaying() ? 'currently-playing' : 'play-btn'">
      <mat-icon [class.text-green-500]="isCurrentSongPlaying()" 
                [class.animate-pulse]="isCurrentSongPlaying()">
        {{ isCurrentSongPlaying() ? 'volume_up' : 'play_arrow' }}
      </mat-icon>
    </button>
  }

  <mat-menu #actionsMenu="matMenu" class="song-actions-menu">
    <button mat-menu-item (click)="playSong()">
      <mat-icon>{{ isCurrentSongPlaying() ? 'pause' : 'play_arrow' }}</mat-icon>
      <span>{{ isCurrentSongPlaying() ? 'Pausar' : 'Reproducir ahora' }}</span>
    </button>
    
    <button mat-menu-item (click)="playNext()">
      <mat-icon>skip_next</mat-icon>
      <span>Reproducir siguiente</span>
    </button>
    
    <button mat-menu-item (click)="addToQueue()">
      <mat-icon>queue</mat-icon>
      <span>Agregar a cola</span>
    </button>
    
    <mat-divider></mat-divider>
    
    <button mat-menu-item (click)="addToPlaylist()">
      <mat-icon>playlist_add</mat-icon>
      <span>Agregar a playlist</span>
    </button>
    
    <button mat-menu-item (click)="addToFavorites()">
      <mat-icon>favorite_border</mat-icon>
      <span>Agregar a favoritos</span>
    </button>
    
    <mat-divider></mat-divider>
    
    <button mat-menu-item (click)="shareSong()">
      <mat-icon>share</mat-icon>
      <span>Compartir</span>
    </button>
    
    <button mat-menu-item (click)="viewInfo()">
      <mat-icon>info</mat-icon>
      <span>Ver información</span>
    </button>
  </mat-menu>

  <!-- More options menu for small/medium buttons -->
  <mat-menu #moreOptionsMenu="matMenu" class="song-actions-menu">
    <button mat-menu-item (click)="playNext()">
      <mat-icon>skip_next</mat-icon>
      <span>Reproducir siguiente</span>
    </button>
    
    <mat-divider></mat-divider>
    
    <button mat-menu-item (click)="shareSong()">
      <mat-icon>share</mat-icon>
      <span>Compartir</span>
    </button>
    
    <button mat-menu-item (click)="viewInfo()">
      <mat-icon>info</mat-icon>
      <span>Ver información</span>
    </button>
  </mat-menu>
</div>
