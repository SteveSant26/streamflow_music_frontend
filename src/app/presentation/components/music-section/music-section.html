<div class="music-section mb-8">
  <!-- Header -->
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-2xl sm:text-3xl font-bold text-white flex items-center gap-2">
      @if (titleIcon) {
        <span>{{ titleIcon }}</span>
      }
      {{ title }}
    </h2>
    
    <div class="flex items-center gap-2">
      <!-- Primary button (like "Ver todas") -->
      @if (primaryButton) {
        <button 
          class="text-black hover:text-gray-700 text-sm font-medium"
          (click)="primaryButton.action()"
          [attr.aria-label]="primaryButton.ariaLabel"
        >
          {{ primaryButton.text }}
        </button>
      }
      
      <!-- Action buttons (like refresh, play) -->
      @for (button of actionButtons; track $index) {
        <button 
          class="p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors"
          (click)="button.action()"
          [attr.aria-label]="button.ariaLabel"
        >
          <mat-icon class="text-white text-base">{{ button.icon }}</mat-icon>
        </button>
      }
    </div>
  </div>
  
  <!-- Loading state -->
  <div *ngIf="loading" class="flex justify-center items-center py-8">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-white"></div>
    @if (loadingMessage) {
      <span class="ml-3 text-white">{{ loadingMessage }}</span>
    }
  </div>
  
  <!-- Content based on type -->
  @if (!loading && songs.length > 0) {
    <!-- Grid layout for songs -->
    @if (type === 'grid') {
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6">
        @for (song of songs; track song.id) {
          <button 
            class="song-card bg-gray-800 rounded-lg p-4 hover:bg-gray-700 transition-colors w-full text-left"
            (click)="onSongClick(song)"
          >
            <img 
              [src]="song.thumbnail_url || 'assets/images/default-album.jpg'" 
              [alt]="song.title"
              class="w-full aspect-square object-cover rounded-md mb-3"
              appImageFallback="assets/images/default-album-small.svg"
            />
            <h3 class="text-white font-medium text-sm truncate">{{ song.title }}</h3>
            <p class="text-gray-400 text-xs truncate">{{ song.artist_name }}</p>
            @if (showPlayCount && song.play_count) {
              <div class="flex items-center mt-2 text-xs text-gray-500">
                <mat-icon class="text-xs mr-1">play_arrow</mat-icon>
                <span>{{ formatPlayCount(song.play_count) }}</span>
              </div>
            }
          </button>
        }
      </div>
    }
    
    <!-- Table layout for songs -->
    @if (type === 'table') {
      <div class="mt-4">
        <app-musics-table [songs]="songs"></app-musics-table>
      </div>
    }
  }
  
  <!-- Empty state -->
  @if (!loading && songs.length === 0) {
    <div class="text-center py-8">
      <mat-icon class="text-gray-400 text-4xl mb-2">music_note</mat-icon>
      <p class="text-gray-400">{{ emptyMessage }}</p>
      <button 
        class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
        (click)="onRetryClick()"
      >
        Reintentar
      </button>
    </div>
  }
</div>
