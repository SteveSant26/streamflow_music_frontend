<div [ngClass]="getContainerClass()">
  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando playlist...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error() && !loading()" class="error-container">
    <mat-icon class="error-icon">error</mat-icon>
    <h2>{{ error() }}</h2>
    <button mat-raised-button color="primary" (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
      Volver a la biblioteca
    </button>
  </div>

  <!-- Playlist Content -->
  <div *ngIf="playlist() && !loading() && !error()" class="playlist-content">
    <!-- Header -->
    <div class="playlist-header">
      <div class="playlist-hero">
        <div class="playlist-cover">
          <img 
            [src]="getPlaylistImage()" 
            [alt]="playlist()?.name || 'Playlist Cover'"
            class="playlist-image"
          />
        </div>
        <div class="playlist-info">
          <span class="playlist-type">Lista p√∫blica</span>
          <h1 class="playlist-title">{{ playlist()?.name }}</h1>
          <p class="playlist-description">{{ playlist()?.description }}</p>
          <div class="playlist-meta">
            <span class="playlist-owner">üéµ {{ playlist()?.owner?.username }}</span>
            <span class="meta-separator">‚Ä¢</span>
            <span class="playlist-stats">
              {{ playlist()?.songCount }} canciones, {{ formatDuration(playlist()?.duration || 0) }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="playlist-controls">
      <button 
        mat-fab 
        color="primary" 
        class="play-button"
        (click)="playPlaylist()"
        [disabled]="!playlist()?.songs?.length"
      >
        <mat-icon>play_arrow</mat-icon>
      </button>
      
      <button mat-icon-button class="action-button">
        <mat-icon>favorite_border</mat-icon>
      </button>
      
      <button mat-icon-button class="action-button">
        <mat-icon>more_horiz</mat-icon>
      </button>
    </div>

    <!-- Songs List -->
    <div class="songs-section">
      <div class="songs-header">
        <div class="song-number">#</div>
        <div class="song-info">T√≠tulo</div>
        <div class="song-album">√Ålbum</div>
        <div class="song-duration">
          <mat-icon class="duration-icon">schedule</mat-icon>
        </div>
      </div>

      <div class="songs-list">
        <div 
          *ngFor="let song of playlist()?.songs; let i = index" 
          class="song-item"
          (click)="playSong(song, i)"
        >
          <div class="song-number">
            <span class="track-number">{{ i + 1 }}</span>
            <button mat-icon-button class="play-song-btn">
              <mat-icon>play_arrow</mat-icon>
            </button>
          </div>
          
          <div class="song-info">
            <div class="song-details">
              <img 
                [src]="song.thumbnailUrl || 'https://picsum.photos/40/40?random=' + i" 
                [alt]="song.title"
                class="song-thumbnail"
              />
              <div class="song-text">
                <div class="song-title">{{ song.title }}</div>
                <div class="song-artist">{{ song.artist }}</div>
              </div>
            </div>
          </div>
          
          <div class="song-album">{{ song.album }}</div>
          
          <div class="song-duration">
            <button 
              mat-icon-button 
              class="add-to-queue-btn"
              (click)="addToQueue(song); $event.stopPropagation()"
            >
              <mat-icon>add</mat-icon>
            </button>
            <span class="duration-text">{{ formatSongDuration(song.duration) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
